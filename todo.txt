todo insert hook calls at the proper places
  * find way to pause stuff until hook completes

